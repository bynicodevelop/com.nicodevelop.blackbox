{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Blackbox Trading Robot","text":"<p>Bienvenue dans la documentation du Blackbox Trading Robot, un projet Python monorepo pour le trading algorithmique.</p>"},{"location":"#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>Core : Logique m\u00e9tier du trading (strat\u00e9gies, signaux, gestion de portefeuille)</li> <li>CLI : Interface ligne de commande pour piloter le robot</li> <li>API : API REST FastAPI pour l'int\u00e9gration avec d'autres syst\u00e8mes</li> <li>Documentation : Documentation compl\u00e8te avec MkDocs</li> </ul>"},{"location":"#installation-rapide","title":"Installation rapide","text":"<pre><code># Cloner le repository\ngit clone https://github.com/nicodevelop/blackbox.git\ncd blackbox\n\n# Installer les d\u00e9pendances\nmake install-dev\n\n# V\u00e9rifier l'installation\nmake test\n</code></pre>"},{"location":"#utilisation","title":"Utilisation","text":""},{"location":"#cli","title":"CLI","text":"<pre><code># Afficher l'aide\nblackbox --help\n\n# V\u00e9rifier le statut\nblackbox status\n\n# Lancer en mode simulation\nblackbox run --dry-run --symbol BTC/USDT\n</code></pre>"},{"location":"#api","title":"API","text":"<pre><code># D\u00e9marrer le serveur\nmake run-api\n\n# Acc\u00e9der \u00e0 la documentation\n# http://localhost:8000/docs\n</code></pre>"},{"location":"#structure-du-projet","title":"Structure du projet","text":"<pre><code>blackbox/\n\u251c\u2500\u2500 src/blackbox/\n\u2502   \u251c\u2500\u2500 core/       # Logique trading\n\u2502   \u251c\u2500\u2500 cli/        # Interface CLI\n\u2502   \u2514\u2500\u2500 api/        # API REST\n\u251c\u2500\u2500 tests/          # Tests unitaires\n\u2514\u2500\u2500 docs/           # Documentation\n</code></pre>"},{"location":"#liens-utiles","title":"Liens utiles","text":"<ul> <li>Guide de d\u00e9marrage</li> <li>Architecture</li> <li>Commandes CLI</li> <li>Endpoints API</li> <li>Mode YOLO (Claude Code)</li> </ul>"},{"location":"architecture/","title":"Architecture","text":"<p>Le Blackbox Trading Robot est organis\u00e9 en monorepo Python avec une s\u00e9paration claire des responsabilit\u00e9s.</p>"},{"location":"architecture/#vue-densemble","title":"Vue d'ensemble","text":"<pre><code>com.nicodevelop.blackbox/\n\u251c\u2500\u2500 src/blackbox/           # Code source\n\u2502   \u251c\u2500\u2500 core/               # Logique m\u00e9tier trading\n\u2502   \u251c\u2500\u2500 data/               # Module donn\u00e9es (calendrier \u00e9conomique)\n\u2502   \u2502   \u251c\u2500\u2500 scraper/        # Scrapers web\n\u2502   \u2502   \u2514\u2500\u2500 storage/        # Persistance PostgreSQL + migrations\n\u2502   \u251c\u2500\u2500 cli/                # Interface ligne de commande\n\u2502   \u2514\u2500\u2500 api/                # API REST FastAPI\n\u251c\u2500\u2500 tests/                  # Tests unitaires et d'int\u00e9gration\n\u251c\u2500\u2500 docs/                   # Documentation MkDocs\n\u251c\u2500\u2500 alembic.ini             # Configuration Alembic\n\u2514\u2500\u2500 scripts/                # Scripts utilitaires\n</code></pre>"},{"location":"architecture/#modules","title":"Modules","text":""},{"location":"architecture/#core-srcblackboxcore","title":"Core (<code>src/blackbox/core/</code>)","text":"<p>Le module core contient toute la logique m\u00e9tier du trading :</p> <ul> <li>Strat\u00e9gies de trading</li> <li>Gestion des signaux d'achat/vente</li> <li>Gestion du portefeuille</li> <li>Calculs de risque</li> <li>Connecteurs aux exchanges</li> <li>Scoring fondamental : Analyse des \u00e9v\u00e9nements \u00e9conomiques</li> </ul> <p>Ce module est ind\u00e9pendant et peut \u00eatre utilis\u00e9 par le CLI et l'API.</p>"},{"location":"architecture/#scoring-srcblackboxcorescoring","title":"Scoring (<code>src/blackbox/core/scoring/</code>)","text":"<p>Le sous-module scoring calcule des scores fondamentaux par devise et des biais directionnels par paire :</p> <pre><code>scoring/\n\u251c\u2500\u2500 __init__.py       # Exports du module\n\u251c\u2500\u2500 config.py         # ScoringConfig (dataclass avec param\u00e8tres)\n\u251c\u2500\u2500 calculator.py     # Fonctions de calcul pures\n\u2514\u2500\u2500 service.py        # ScoringService (int\u00e9gration repository)\n</code></pre> <p>Composants principaux :</p> <ul> <li>ScoringConfig : Configuration avec <code>half_life_hours</code>, <code>lookback_days</code>, <code>min_bias_threshold</code></li> <li>ScoringService : Service principal qui int\u00e8gre le repository d'\u00e9v\u00e9nements</li> <li>Fonctions de calcul :</li> <li><code>calculate_decay()</code> : D\u00e9croissance temporelle exponentielle (0.5^(heures/demi-vie))</li> <li><code>calculate_event_force()</code> : Force d'un \u00e9v\u00e9nement (surprise \u00d7 poids \u00d7 decay)</li> <li><code>calculate_currency_score()</code> : Score agr\u00e9g\u00e9 pour une devise</li> <li><code>calculate_pair_bias()</code> : Biais directionnel (base_score - quote_score)</li> <li><code>get_bias_signal()</code> : Signal BULLISH/BEARISH/NEUTRAL</li> </ul> <p>Flux de scoring :</p> <pre><code>EventRepository \u2192 ScoringService \u2192 Scores par devise\n                                 \u2192 Biais par paire\n                                 \u2192 Signaux directionnels\n</code></pre>"},{"location":"architecture/#data-srcblackboxdata","title":"Data (<code>src/blackbox/data/</code>)","text":"<p>Le module data g\u00e8re la r\u00e9cup\u00e9ration de donn\u00e9es externes :</p> <ul> <li>Calendrier \u00e9conomique : Scraping des \u00e9v\u00e9nements depuis Forex Factory</li> <li>Mod\u00e8les Pydantic : <code>EconomicEvent</code>, <code>CalendarDay</code>, <code>CalendarMonth</code></li> <li>Configuration : Gestion des d\u00e9lais, user-agents, timeouts</li> <li>Browser Manager : Utilise <code>undetected-chromedriver</code> pour \u00e9viter la d\u00e9tection bot</li> </ul> <p>Structure du module :</p> <pre><code>data/\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 models.py             # Mod\u00e8les Pydantic (EconomicEvent, EventType, etc.)\n\u251c\u2500\u2500 event_mapping.py      # Mapping \u00e9v\u00e9nements \u2192 m\u00e9tadonn\u00e9es (type, direction, poids)\n\u251c\u2500\u2500 scoring.py            # Calculs de scoring (surprise, etc.)\n\u251c\u2500\u2500 config.py             # Configuration scraper\n\u251c\u2500\u2500 exceptions.py         # Exceptions personnalis\u00e9es\n\u251c\u2500\u2500 services.py           # CalendarService (orchestration scraper + DB)\n\u251c\u2500\u2500 scraper/\n\u2502   \u251c\u2500\u2500 base.py           # Classe abstraite BaseScraper\n\u2502   \u251c\u2500\u2500 browser.py        # Gestion navigateur\n\u2502   \u2514\u2500\u2500 forex_factory.py  # Impl\u00e9mentation Forex Factory\n\u2514\u2500\u2500 storage/\n    \u251c\u2500\u2500 database.py       # Connexion PostgreSQL + session factory\n    \u251c\u2500\u2500 models.py         # Mod\u00e8les SQLAlchemy (EconomicEventDB)\n    \u251c\u2500\u2500 repository.py     # Pattern Repository (CRUD)\n    \u2514\u2500\u2500 migrations/       # Migrations Alembic\n        \u251c\u2500\u2500 env.py\n        \u251c\u2500\u2500 script.py.mako\n        \u2514\u2500\u2500 versions/     # Fichiers de migration versionn\u00e9s\n</code></pre>"},{"location":"architecture/#storage-layer","title":"Storage Layer","text":"<p>Le module storage g\u00e8re la persistance des donn\u00e9es :</p> <ul> <li>SQLAlchemy 2.0+ : ORM moderne avec support des types Python natifs</li> <li>Alembic : Migrations de sch\u00e9ma versionn\u00e9es</li> <li>PostgreSQL : Base de donn\u00e9es cible</li> <li>Pattern Repository : Abstraction des op\u00e9rations CRUD</li> </ul> <p>Flux de donn\u00e9es :</p> <pre><code>Scraper \u2192 Pydantic Models \u2192 Repository \u2192 SQLAlchemy \u2192 PostgreSQL\n                \u2191                            \u2193\n           (enrichissement)            (persistance)\n           event_mapping.py\n</code></pre>"},{"location":"architecture/#cli-srcblackboxcli","title":"CLI (<code>src/blackbox/cli/</code>)","text":"<p>Le module CLI fournit une interface ligne de commande bas\u00e9e sur Click :</p> <ul> <li>Commandes pour g\u00e9rer le robot</li> <li>Configuration interactive</li> <li>Monitoring en temps r\u00e9el</li> </ul>"},{"location":"architecture/#api-srcblackboxapi","title":"API (<code>src/blackbox/api/</code>)","text":"<p>Le module API expose une API REST avec FastAPI :</p> <ul> <li>Documentation automatique (Swagger/OpenAPI) sur <code>/docs</code></li> <li>CORS activ\u00e9 pour le d\u00e9veloppement</li> </ul>"},{"location":"architecture/#endpoints-disponibles","title":"Endpoints disponibles","text":"<p>Calendrier \u00e9conomique :</p> Endpoint Description <code>GET /api/v1/calendar/month</code> \u00c9v\u00e9nements d'un mois <code>GET /api/v1/calendar/today</code> \u00c9v\u00e9nements du jour <code>POST /api/v1/calendar/refresh</code> Rafra\u00eechir les donn\u00e9es <code>GET /api/v1/calendar/stats</code> Statistiques de la base <p>Scoring fondamental :</p> Endpoint Description <code>GET /api/v1/scoring/currency/{currency}</code> Score d'une devise <code>GET /api/v1/scoring/pair/{base}/{quote}</code> Biais d'une paire <code>GET /api/v1/scoring/signal/{base}/{quote}</code> Signal BULLISH/BEARISH/NEUTRAL <p>Param\u00e8tres de scoring :</p> <ul> <li><code>half_life_hours</code> (d\u00e9faut: 48) - Demi-vie pour la d\u00e9croissance temporelle</li> <li><code>lookback_days</code> (d\u00e9faut: 7) - Nombre de jours \u00e0 analyser</li> <li><code>min_bias_threshold</code> (d\u00e9faut: 1.0) - Seuil pour g\u00e9n\u00e9rer un signal directionnel</li> </ul> <p>Exemple d'appel :</p> <pre><code># Score EUR avec d\u00e9croissance de 24h sur 14 jours\ncurl \"http://localhost:8000/api/v1/scoring/currency/EUR?half_life_hours=24&amp;lookback_days=14\"\n\n# Signal EUR/USD avec seuil de 2.0\ncurl \"http://localhost:8000/api/v1/scoring/signal/EUR/USD?min_bias_threshold=2.0\"\n</code></pre>"},{"location":"architecture/#flux-de-donnees","title":"Flux de donn\u00e9es","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Utilisateur                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2502                \u2502\n                    \u25bc                \u25bc\n            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n            \u2502    CLI    \u2502    \u2502    API    \u2502\n            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2502                \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502     Core      \u2502\n                    \u2502  (Trading)    \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502\n                             \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   Exchange    \u2502\n                    \u2502   (Externe)   \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#technologies","title":"Technologies","text":"Composant Technologie Langage Python 3.11+ CLI Click API FastAPI + Uvicorn Mod\u00e8les donn\u00e9es Pydantic Base de donn\u00e9es PostgreSQL ORM SQLAlchemy 2.0+ Migrations Alembic Scraping Selenium + undetected-chromedriver Parsing HTML BeautifulSoup + lxml Retry Tenacity Tests Pytest Linting Ruff Documentation MkDocs Material"},{"location":"architecture/#principes-de-conception","title":"Principes de conception","text":""},{"location":"architecture/#separation-des-preoccupations","title":"S\u00e9paration des pr\u00e9occupations","text":"<p>Chaque module a une responsabilit\u00e9 unique :</p> <ul> <li>Core : Logique m\u00e9tier pure</li> <li>CLI : Pr\u00e9sentation en ligne de commande</li> <li>API : Pr\u00e9sentation HTTP/REST</li> </ul>"},{"location":"architecture/#testabilite","title":"Testabilit\u00e9","text":"<p>Le code est con\u00e7u pour \u00eatre facilement testable :</p> <ul> <li>Injection de d\u00e9pendances</li> <li>Interfaces claires entre modules</li> <li>Mocks pour les services externes</li> </ul>"},{"location":"architecture/#extensibilite","title":"Extensibilit\u00e9","text":"<p>L'architecture permet d'ajouter facilement :</p> <ul> <li>Nouvelles strat\u00e9gies de trading</li> <li>Nouveaux connecteurs d'exchange</li> <li>Nouvelles interfaces (Web, mobile, etc.)</li> </ul>"},{"location":"getting-started/","title":"Guide de D\u00e9marrage","text":"<p>Ce guide vous accompagne dans l'installation et la configuration du Blackbox Trading Robot.</p>"},{"location":"getting-started/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Python 3.11 ou sup\u00e9rieur</li> <li>pip (gestionnaire de paquets Python)</li> <li>Git</li> <li>PostgreSQL 14+ (pour la persistance des donn\u00e9es)</li> <li>Google Chrome (pour le scraping)</li> </ul>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#1-cloner-le-repository","title":"1. Cloner le repository","text":"<pre><code>git clone https://github.com/nicodevelop/blackbox.git\ncd blackbox\n</code></pre>"},{"location":"getting-started/#2-installation-pour-le-developpement","title":"2. Installation pour le d\u00e9veloppement","text":"<pre><code># Cr\u00e9er le venv et installer les d\u00e9pendances dev\nmake install-dev\n</code></pre> <p>Cette commande :</p> <ul> <li>Cr\u00e9e un environnement virtuel <code>.venv</code></li> <li>Installe toutes les d\u00e9pendances (production + d\u00e9veloppement)</li> <li>Installe le package en mode \u00e9ditable</li> <li>Configure les hooks pre-commit</li> </ul>"},{"location":"getting-started/#3-installation-production-uniquement","title":"3. Installation production uniquement","text":"<pre><code>make install\n</code></pre>"},{"location":"getting-started/#verification-de-linstallation","title":"V\u00e9rification de l'installation","text":""},{"location":"getting-started/#lancer-les-tests","title":"Lancer les tests","text":"<pre><code>make test\n</code></pre>"},{"location":"getting-started/#verifier-le-linting","title":"V\u00e9rifier le linting","text":"<pre><code>make lint\n</code></pre>"},{"location":"getting-started/#tester-le-cli","title":"Tester le CLI","text":"<pre><code># Activer le venv si ce n'est pas fait\nsource .venv/bin/activate\n\n# Afficher l'aide\nblackbox --help\n\n# V\u00e9rifier le statut\nblackbox status\n</code></pre>"},{"location":"getting-started/#tester-lapi","title":"Tester l'API","text":"<pre><code># D\u00e9marrer le serveur\nmake run-api\n\n# Dans un autre terminal, tester\ncurl http://localhost:8000/health\n</code></pre>"},{"location":"getting-started/#commandes-make-disponibles","title":"Commandes Make disponibles","text":"Commande Description <code>make install</code> Installe les d\u00e9pendances production <code>make install-dev</code> Installe les d\u00e9pendances d\u00e9veloppement <code>make test</code> Lance les tests avec couverture <code>make lint</code> V\u00e9rifie le code avec ruff <code>make format</code> Formate le code <code>make run-api</code> Lance le serveur API <code>make run-cli</code> Lance le CLI <code>make docs</code> Sert la documentation localement <code>make clean</code> Nettoie les fichiers g\u00e9n\u00e9r\u00e9s"},{"location":"getting-started/#configuration","title":"Configuration","text":""},{"location":"getting-started/#variables-denvironnement","title":"Variables d'environnement","text":"<p>Cr\u00e9ez un fichier <code>.env</code> \u00e0 la racine du projet :</p> <pre><code># Mode debug\nDEBUG=true\n\n# Configuration API\nAPI_HOST=0.0.0.0\nAPI_PORT=8000\n\n# Base de donn\u00e9es PostgreSQL\nDATABASE_URL_SYNC=postgresql+psycopg2://blackbox:blackbox_dev@localhost:5432/blackbox\n\n# Configuration trading (\u00e0 venir)\n# EXCHANGE_API_KEY=your_key\n# EXCHANGE_SECRET=your_secret\n</code></pre>"},{"location":"getting-started/#configuration-postgresql","title":"Configuration PostgreSQL","text":"<ol> <li>Cr\u00e9er la base de donn\u00e9es :</li> </ol> <pre><code># Se connecter \u00e0 PostgreSQL\npsql -U postgres\n\n# Cr\u00e9er l'utilisateur et la base\nCREATE USER blackbox WITH PASSWORD 'blackbox_dev';\nCREATE DATABASE blackbox OWNER blackbox;\n\\q\n</code></pre> <ol> <li>Ex\u00e9cuter les migrations :</li> </ol> <pre><code># Appliquer toutes les migrations\nblackbox db migrate\n\n# V\u00e9rifier le statut\nblackbox db migrate-status\n</code></pre> <p>Note : Les migrations utilisent Alembic et sont versionn\u00e9es dans <code>src/blackbox/data/storage/migrations/</code>.</p>"},{"location":"getting-started/#premiere-execution","title":"Premi\u00e8re ex\u00e9cution","text":"<p>Apr\u00e8s l'installation et la configuration de la base de donn\u00e9es :</p> <pre><code># R\u00e9cup\u00e9rer les \u00e9v\u00e9nements du mois en cours\nblackbox calendar fetch\n\n# V\u00e9rifier les donn\u00e9es stock\u00e9es\nblackbox db stats\n</code></pre>"},{"location":"getting-started/#prochaines-etapes","title":"Prochaines \u00e9tapes","text":"<ul> <li>Consultez l'Architecture pour comprendre la structure du projet</li> <li>Explorez les Commandes CLI</li> <li>D\u00e9couvrez les Endpoints API</li> </ul>"},{"location":"api/endpoints/","title":"Endpoints API","text":"<p>L'API REST du Blackbox Trading Robot est construite avec FastAPI.</p>"},{"location":"api/endpoints/#demarrage","title":"D\u00e9marrage","text":"<pre><code># Via Make\nmake run-api\n\n# Ou directement\nuvicorn blackbox.api.main:app --reload --port 8000\n</code></pre> <p>L'API est accessible sur <code>http://localhost:8000</code>.</p>"},{"location":"api/endpoints/#documentation-interactive","title":"Documentation interactive","text":"<p>FastAPI g\u00e9n\u00e8re automatiquement une documentation interactive :</p> <ul> <li>Swagger UI : http://localhost:8000/docs</li> <li>ReDoc : http://localhost:8000/redoc</li> </ul>"},{"location":"api/endpoints/#endpoints","title":"Endpoints","text":""},{"location":"api/endpoints/#general","title":"G\u00e9n\u00e9ral","text":""},{"location":"api/endpoints/#get","title":"<code>GET /</code>","text":"<p>Retourne les informations de l'API.</p> <p>R\u00e9ponse :</p> <pre><code>{\n  \"name\": \"Blackbox Trading Robot API\",\n  \"version\": \"0.1.0\",\n  \"status\": \"running\"\n}\n</code></pre>"},{"location":"api/endpoints/#get-health","title":"<code>GET /health</code>","text":"<p>V\u00e9rifie que l'API est op\u00e9rationnelle.</p> <p>R\u00e9ponse :</p> <pre><code>{\n  \"status\": \"healthy\"\n}\n</code></pre>"},{"location":"api/endpoints/#statut","title":"Statut","text":""},{"location":"api/endpoints/#get-apiv1status","title":"<code>GET /api/v1/status</code>","text":"<p>Retourne le statut d\u00e9taill\u00e9 du robot.</p> <p>R\u00e9ponse :</p> <pre><code>{\n  \"status\": \"ready\",\n  \"version\": \"0.1.0\",\n  \"trading\": false,\n  \"active_strategies\": []\n}\n</code></pre>"},{"location":"api/endpoints/#strategies","title":"Strat\u00e9gies","text":""},{"location":"api/endpoints/#get-apiv1strategies","title":"<code>GET /api/v1/strategies</code>","text":"<p>Liste toutes les strat\u00e9gies disponibles.</p> <p>R\u00e9ponse :</p> <pre><code>{\n  \"strategies\": [],\n  \"message\": \"No strategies configured yet\"\n}\n</code></pre>"},{"location":"api/endpoints/#post-apiv1strategiesstrategy_namestart","title":"<code>POST /api/v1/strategies/{strategy_name}/start</code>","text":"<p>D\u00e9marre une strat\u00e9gie de trading.</p> <p>Param\u00e8tres :</p> Param\u00e8tre Type Description <code>strategy_name</code> path Nom de la strat\u00e9gie <code>dry_run</code> query Mode simulation (d\u00e9faut: <code>true</code>) <p>Exemple :</p> <pre><code>curl -X POST \"http://localhost:8000/api/v1/strategies/ma_strategie/start?dry_run=true\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"message\": \"Strategy 'ma_strategie' start requested\",\n  \"dry_run\": true,\n  \"status\": \"not_implemented\"\n}\n</code></pre>"},{"location":"api/endpoints/#post-apiv1strategiesstrategy_namestop","title":"<code>POST /api/v1/strategies/{strategy_name}/stop</code>","text":"<p>Arr\u00eate une strat\u00e9gie en cours.</p> <p>Param\u00e8tres :</p> Param\u00e8tre Type Description <code>strategy_name</code> path Nom de la strat\u00e9gie <p>Exemple :</p> <pre><code>curl -X POST \"http://localhost:8000/api/v1/strategies/ma_strategie/stop\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"message\": \"Strategy 'ma_strategie' stop requested\",\n  \"status\": \"not_implemented\"\n}\n</code></pre>"},{"location":"api/endpoints/#calendrier-economique","title":"Calendrier \u00e9conomique","text":"<p>Le module calendrier permet de r\u00e9cup\u00e9rer les \u00e9v\u00e9nements \u00e9conomiques depuis Forex Factory.</p>"},{"location":"api/endpoints/#get-apiv1calendarmonth","title":"<code>GET /api/v1/calendar/month</code>","text":"<p>R\u00e9cup\u00e8re le calendrier \u00e9conomique pour un mois donn\u00e9.</p> <p>Param\u00e8tres :</p> Param\u00e8tre Type Description Requis <code>year</code> query Ann\u00e9e (2000-2100) Oui <code>month</code> query Mois (1-12) Oui <code>currencies</code> query Devises s\u00e9par\u00e9es par des virgules (ex: <code>USD,EUR</code>) Non <code>high_impact_only</code> query Uniquement les \u00e9v\u00e9nements \u00e0 fort impact Non (d\u00e9faut: <code>false</code>) <p>Exemple :</p> <pre><code>curl \"http://localhost:8000/api/v1/calendar/month?year=2026&amp;month=1\"\n\n# Avec filtres\ncurl \"http://localhost:8000/api/v1/calendar/month?year=2026&amp;month=1&amp;currencies=USD,EUR&amp;high_impact_only=true\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"year\": 2026,\n  \"month\": 1,\n  \"total_events\": 45,\n  \"events\": [\n    {\n      \"date\": \"2026-01-02\",\n      \"time\": \"08:30:00\",\n      \"currency\": \"USD\",\n      \"impact\": \"high\",\n      \"event_name\": \"Non-Farm Employment Change\",\n      \"actual\": \"223K\",\n      \"forecast\": \"215K\",\n      \"previous\": \"212K\"\n    },\n    ...\n  ]\n}\n</code></pre>"},{"location":"api/endpoints/#get-apiv1calendartoday","title":"<code>GET /api/v1/calendar/today</code>","text":"<p>R\u00e9cup\u00e8re les \u00e9v\u00e9nements \u00e9conomiques du jour.</p> <p>Param\u00e8tres :</p> Param\u00e8tre Type Description Requis <code>currencies</code> query Devises s\u00e9par\u00e9es par des virgules Non <code>high_impact_only</code> query Uniquement les \u00e9v\u00e9nements \u00e0 fort impact Non (d\u00e9faut: <code>false</code>) <p>Exemple :</p> <pre><code>curl \"http://localhost:8000/api/v1/calendar/today\"\n\n# Avec filtres\ncurl \"http://localhost:8000/api/v1/calendar/today?currencies=USD&amp;high_impact_only=true\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"date\": \"2026-01-18\",\n  \"total_events\": 5,\n  \"events\": [\n    {\n      \"date\": \"2026-01-18\",\n      \"time\": \"08:30:00\",\n      \"currency\": \"USD\",\n      \"impact\": \"high\",\n      \"event_name\": \"Building Permits\",\n      \"actual\": null,\n      \"forecast\": \"1.45M\",\n      \"previous\": \"1.42M\"\n    },\n    ...\n  ]\n}\n</code></pre>"},{"location":"api/endpoints/#post-apiv1calendarrefresh","title":"<code>POST /api/v1/calendar/refresh</code>","text":"<p>D\u00e9clenche un rafra\u00eechissement en arri\u00e8re-plan des donn\u00e9es du calendrier.</p> <p>Param\u00e8tres :</p> Param\u00e8tre Type Description Requis <code>year</code> query Ann\u00e9e \u00e0 rafra\u00eechir Non (d\u00e9faut: ann\u00e9e courante) <code>month</code> query Mois \u00e0 rafra\u00eechir Non (d\u00e9faut: mois courant) <p>Exemple :</p> <pre><code>curl -X POST \"http://localhost:8000/api/v1/calendar/refresh?year=2026&amp;month=1\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"status\": \"started\",\n  \"message\": \"Calendar refresh started for 2026-01\"\n}\n</code></pre>"},{"location":"api/endpoints/#get-apiv1calendarrefreshstatus","title":"<code>GET /api/v1/calendar/refresh/status</code>","text":"<p>V\u00e9rifie le statut du dernier rafra\u00eechissement.</p> <p>Exemple :</p> <pre><code>curl \"http://localhost:8000/api/v1/calendar/refresh/status\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"status\": \"completed\",\n  \"message\": \"Successfully refreshed 2026-01\"\n}\n</code></pre> <p>Statuts possibles :</p> Statut Description <code>idle</code> Aucun rafra\u00eechissement en cours <code>running</code> Rafra\u00eechissement en cours <code>completed</code> Rafra\u00eechissement termin\u00e9 avec succ\u00e8s <code>error</code> Erreur lors du rafra\u00eechissement"},{"location":"api/endpoints/#scoring-fondamental","title":"Scoring fondamental","text":"<p>Le module scoring calcule des scores fondamentaux par devise et des biais directionnels par paire, bas\u00e9s sur les \u00e9v\u00e9nements \u00e9conomiques avec d\u00e9croissance temporelle.</p>"},{"location":"api/endpoints/#get-apiv1scoringcurrencycurrency","title":"<code>GET /api/v1/scoring/currency/{currency}</code>","text":"<p>Calcule le score fondamental d'une devise.</p> <p>Param\u00e8tres :</p> Param\u00e8tre Type Description Requis <code>currency</code> path Code devise (ex: <code>USD</code>, <code>EUR</code>) Oui <code>half_life_hours</code> query Demi-vie pour la d\u00e9croissance (heures) Non (d\u00e9faut: <code>48</code>) <code>lookback_days</code> query Jours \u00e0 analyser Non (d\u00e9faut: <code>7</code>) <p>Exemple :</p> <pre><code>curl \"http://localhost:8000/api/v1/scoring/currency/EUR\"\n\n# Avec param\u00e8tres personnalis\u00e9s\ncurl \"http://localhost:8000/api/v1/scoring/currency/USD?half_life_hours=24&amp;lookback_days=14\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"currency\": \"EUR\",\n  \"score\": 2.7539,\n  \"reference_time\": \"2026-01-18T21:22:09.684849\",\n  \"config\": {\n    \"half_life_hours\": 48.0,\n    \"lookback_days\": 7\n  }\n}\n</code></pre> <p>Interpr\u00e9tation du score :</p> <ul> <li>Score positif \u2192 Sentiment haussier sur la devise</li> <li>Score n\u00e9gatif \u2192 Sentiment baissier sur la devise</li> <li>Score proche de 0 \u2192 Sentiment neutre</li> </ul>"},{"location":"api/endpoints/#get-apiv1scoringpairbasequote","title":"<code>GET /api/v1/scoring/pair/{base}/{quote}</code>","text":"<p>Calcule le biais directionnel d'une paire de devises.</p> <p>Param\u00e8tres :</p> Param\u00e8tre Type Description Requis <code>base</code> path Devise de base (ex: <code>EUR</code> dans EURUSD) Oui <code>quote</code> path Devise de cotation (ex: <code>USD</code> dans EURUSD) Oui <code>half_life_hours</code> query Demi-vie pour la d\u00e9croissance (heures) Non (d\u00e9faut: <code>48</code>) <code>lookback_days</code> query Jours \u00e0 analyser Non (d\u00e9faut: <code>7</code>) <p>Exemple :</p> <pre><code>curl \"http://localhost:8000/api/v1/scoring/pair/EUR/USD\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"base\": \"EUR\",\n  \"quote\": \"USD\",\n  \"pair\": \"EURUSD\",\n  \"base_score\": 2.7539,\n  \"quote_score\": 32.6464,\n  \"bias\": -29.8925,\n  \"reference_time\": \"2026-01-18T21:22:09.684849\"\n}\n</code></pre> <p>Interpr\u00e9tation du biais :</p> <p>Le biais est calcul\u00e9 comme : <code>base_score - quote_score</code></p> <ul> <li>Biais positif \u2192 Sentiment haussier sur la paire (base plus forte que quote)</li> <li>Biais n\u00e9gatif \u2192 Sentiment baissier sur la paire (quote plus forte que base)</li> </ul>"},{"location":"api/endpoints/#get-apiv1scoringsignalbasequote","title":"<code>GET /api/v1/scoring/signal/{base}/{quote}</code>","text":"<p>G\u00e9n\u00e8re un signal de trading pour une paire de devises.</p> <p>Param\u00e8tres :</p> Param\u00e8tre Type Description Requis <code>base</code> path Devise de base Oui <code>quote</code> path Devise de cotation Oui <code>half_life_hours</code> query Demi-vie pour la d\u00e9croissance (heures) Non (d\u00e9faut: <code>48</code>) <code>lookback_days</code> query Jours \u00e0 analyser Non (d\u00e9faut: <code>7</code>) <code>min_bias_threshold</code> query Seuil minimum pour g\u00e9n\u00e9rer un signal directionnel Non (d\u00e9faut: <code>1.0</code>) <p>Exemple :</p> <pre><code>curl \"http://localhost:8000/api/v1/scoring/signal/EUR/USD\"\n\n# Avec seuil personnalis\u00e9\ncurl \"http://localhost:8000/api/v1/scoring/signal/EUR/USD?min_bias_threshold=5.0\"\n</code></pre> <p>R\u00e9ponse :</p> <pre><code>{\n  \"base\": \"EUR\",\n  \"quote\": \"USD\",\n  \"pair\": \"EURUSD\",\n  \"bias\": -29.8925,\n  \"signal\": \"BEARISH\",\n  \"threshold\": 1.0,\n  \"reference_time\": \"2026-01-18T21:22:09.684849\"\n}\n</code></pre> <p>Signaux possibles :</p> Signal Condition <code>BULLISH</code> biais &gt; seuil <code>BEARISH</code> biais &lt; -seuil <code>NEUTRAL</code> |biais| \u2264 seuil"},{"location":"api/endpoints/#codes-http","title":"Codes HTTP","text":"Code Signification 200 Succ\u00e8s 400 Requ\u00eate invalide 404 Ressource non trouv\u00e9e 500 Erreur serveur 503 Service indisponible (erreur scraper)"},{"location":"api/endpoints/#authentification","title":"Authentification","text":"<p>\u00c0 venir</p> <p>L'authentification n'est pas encore impl\u00e9ment\u00e9e. Les endpoints sont actuellement ouverts.</p>"},{"location":"api/endpoints/#cors","title":"CORS","text":"<p>L'API accepte les requ\u00eates de toutes origines par d\u00e9faut. Cette configuration doit \u00eatre restreinte en production.</p>"},{"location":"claude/yolo-mode/","title":"Mode YOLO (Explore YOLO)","text":"<p>Le mode YOLO permet a Claude Code de travailler de maniere autonome sur des taches complexes sans demander de confirmation a chaque etape. Ce mode est ideal pour les taches bien definies ou vous faites confiance a l'agent pour prendre des decisions.</p>"},{"location":"claude/yolo-mode/#commandes-disponibles","title":"Commandes disponibles","text":"Commande Description <code>/explore-yolo</code> Demarre une session YOLO sur une nouvelle branche <code>/explore-status</code> Affiche le statut de la session YOLO en cours <code>/explore-review</code> Review et valide les changements effectues"},{"location":"claude/yolo-mode/#workflow-complet","title":"Workflow complet","text":""},{"location":"claude/yolo-mode/#1-demarrer-une-session-yolo","title":"1. Demarrer une session YOLO","text":"<pre><code>/explore-yolo &lt;description de la tache&gt;\n</code></pre> <p>Cette commande :</p> <ul> <li>Cree une nouvelle branche Git dediee (format: <code>yolo/&lt;id-unique&gt;</code>)</li> <li>Configure Claude Code en mode autonome</li> <li>Demarre l'execution de la tache sans interruptions</li> </ul> <p>Exemple :</p> <pre><code>/explore-yolo Ajouter une commande CLI pour exporter les donnees en CSV\n</code></pre> <p>Claude va alors :</p> <ol> <li>Analyser la codebase existante</li> <li>Identifier les fichiers a modifier</li> <li>Implementer la fonctionnalite</li> <li>Ecrire les tests</li> <li>Verifier que tout compile et passe les tests</li> </ol>"},{"location":"claude/yolo-mode/#2-suivre-la-progression","title":"2. Suivre la progression","text":"<p>Pendant que Claude travaille, vous pouvez verifier l'avancement :</p> <pre><code>/explore-status\n</code></pre> <p>Cette commande affiche :</p> <ul> <li>La branche YOLO active</li> <li>Les fichiers modifies</li> <li>Les taches completees</li> <li>Les taches en cours</li> <li>Les erreurs eventuelles</li> </ul> <p>Exemple de sortie :</p> <pre><code>Session YOLO: yolo/91269117\nBranche: yolo/91269117\nStatut: En cours\n\nFichiers modifies:\n  - src/blackbox/cli/main.py\n  - src/blackbox/cli/commands/export.py (nouveau)\n  - tests/cli/test_export.py (nouveau)\n\nProgression:\n  [x] Analyse de la codebase\n  [x] Creation du module export\n  [x] Implementation de la commande\n  [ ] Ecriture des tests\n  [ ] Verification lint/tests\n</code></pre>"},{"location":"claude/yolo-mode/#3-reviewer-les-changements","title":"3. Reviewer les changements","text":"<p>Une fois la tache terminee, reviewez les changements :</p> <pre><code>/explore-review\n</code></pre> <p>Cette commande permet de :</p> <ul> <li>Voir un resume de tous les changements effectues</li> <li>Consulter le diff complet</li> <li>Valider ou rejeter les modifications</li> <li>Merger dans la branche principale si approuve</li> </ul> <p>Options disponibles lors du review :</p> <ul> <li>Approuver : Merge les changements dans la branche principale</li> <li>Modifier : Demander des ajustements specifiques</li> <li>Rejeter : Annuler tous les changements et supprimer la branche</li> </ul>"},{"location":"claude/yolo-mode/#bonnes-pratiques","title":"Bonnes pratiques","text":""},{"location":"claude/yolo-mode/#quand-utiliser-le-mode-yolo","title":"Quand utiliser le mode YOLO","text":"<ul> <li>Taches bien definies avec un scope clair</li> <li>Ajout de nouvelles fonctionnalites isolees</li> <li>Refactoring avec des regles precises</li> <li>Generation de tests pour du code existant</li> <li>Corrections de bugs simples</li> </ul>"},{"location":"claude/yolo-mode/#quand-eviter-le-mode-yolo","title":"Quand eviter le mode YOLO","text":"<ul> <li>Modifications critiques en production</li> <li>Changements architecturaux majeurs</li> <li>Taches necessitant des decisions business</li> <li>Code touchant a la securite ou aux paiements</li> </ul>"},{"location":"claude/yolo-mode/#exemples-pratiques","title":"Exemples pratiques","text":""},{"location":"claude/yolo-mode/#exemple-1-ajouter-un-endpoint-api","title":"Exemple 1 : Ajouter un endpoint API","text":"<pre><code>/explore-yolo Creer un endpoint GET /api/v1/portfolio qui retourne le portfolio actuel avec les positions ouvertes\n</code></pre> <p>Claude va :</p> <ol> <li>Analyser les endpoints existants dans <code>src/blackbox/api/</code></li> <li>Creer le nouveau endpoint en suivant les patterns existants</li> <li>Ajouter les modeles Pydantic necessaires</li> <li>Ecrire les tests unitaires</li> <li>Mettre a jour la documentation OpenAPI</li> </ol>"},{"location":"claude/yolo-mode/#exemple-2-ajouter-une-commande-cli","title":"Exemple 2 : Ajouter une commande CLI","text":"<pre><code>/explore-yolo Ajouter une commande 'blackbox calendar --export json' pour exporter le calendrier economique\n</code></pre> <p>Claude va :</p> <ol> <li>Examiner les commandes CLI existantes</li> <li>Ajouter l'option <code>--export</code> a la commande calendar</li> <li>Implementer l'export JSON</li> <li>Tester la commande</li> <li>Mettre a jour l'aide de la commande</li> </ol>"},{"location":"claude/yolo-mode/#exemple-3-refactoring","title":"Exemple 3 : Refactoring","text":"<pre><code>/explore-yolo Extraire la logique de validation des signaux dans un module dedie src/blackbox/core/validation.py\n</code></pre> <p>Claude va :</p> <ol> <li>Identifier toute la logique de validation dispersee</li> <li>Creer le nouveau module</li> <li>Migrer le code en preservant les tests</li> <li>Verifier que tous les tests passent</li> </ol>"},{"location":"claude/yolo-mode/#gestion-des-erreurs","title":"Gestion des erreurs","text":"<p>Si Claude rencontre une erreur pendant l'execution :</p> <ol> <li>La session est mise en pause</li> <li>L'erreur est logguee dans le statut</li> <li>Vous pouvez corriger manuellement ou relancer</li> </ol> <pre><code># Voir l'erreur\n/explore-status\n\n# Reprendre apres correction manuelle\n/explore-yolo --resume\n</code></pre>"},{"location":"claude/yolo-mode/#configuration","title":"Configuration","text":"<p>Le mode YOLO respecte les configurations du projet :</p> <ul> <li>Linting : ruff avec les regles du projet</li> <li>Tests : pytest avec couverture</li> <li>Pre-commit hooks : executes avant chaque commit</li> </ul>"},{"location":"claude/yolo-mode/#securite","title":"Securite","text":"<ul> <li>Les changements sont toujours sur une branche separee</li> <li>Aucun push automatique vers <code>main</code> ou <code>master</code></li> <li>Review obligatoire avant merge</li> <li>Possibilite de rollback complet</li> </ul>"},{"location":"claude/yolo-mode/#comparaison-avec-le-mode-standard","title":"Comparaison avec le mode standard","text":"Aspect Mode Standard Mode YOLO Confirmations A chaque etape Aucune Branche Branche courante Nouvelle branche dediee Vitesse Plus lent Plus rapide Controle Total Apres coup Ideal pour Taches sensibles Taches bien definies"},{"location":"cli/commands/","title":"Commandes CLI","text":"<p>Le Blackbox Trading Robot dispose d'une interface ligne de commande compl\u00e8te.</p>"},{"location":"cli/commands/#installation","title":"Installation","text":"<p>Apr\u00e8s installation du projet, la commande <code>blackbox</code> est disponible :</p> <pre><code># Avec le venv activ\u00e9\nblackbox --help\n\n# Ou via Make\nmake run-cli\n</code></pre>"},{"location":"cli/commands/#commandes-disponibles","title":"Commandes disponibles","text":""},{"location":"cli/commands/#blackbox-help","title":"<code>blackbox --help</code>","text":"<p>Affiche l'aide g\u00e9n\u00e9rale et la liste des commandes.</p> <pre><code>$ blackbox --help\nUsage: blackbox [OPTIONS] COMMAND [ARGS]...\n\n  Blackbox Trading Robot CLI.\n\n  A command-line interface for managing and running trading strategies.\n\nOptions:\n  --version  Show the version and exit.\n  --help     Show this message and exit.\n\nCommands:\n  backtest  Run backtesting for a strategy.\n  calendar  Economic calendar commands.\n  run       Start the trading robot.\n  status    Display the current status of the trading robot.\n</code></pre>"},{"location":"cli/commands/#blackbox-version","title":"<code>blackbox --version</code>","text":"<p>Affiche la version du robot.</p> <pre><code>$ blackbox --version\nblackbox, version 0.1.0\n</code></pre>"},{"location":"cli/commands/#blackbox-status","title":"<code>blackbox status</code>","text":"<p>Affiche le statut actuel du robot.</p> <pre><code>$ blackbox status\nBlackbox Trading Robot\nVersion: 0.1.0\nStatus: Ready\n</code></pre>"},{"location":"cli/commands/#blackbox-run","title":"<code>blackbox run</code>","text":"<p>Lance le robot de trading.</p> <p>Options :</p> Option Description D\u00e9faut <code>-s, --symbol</code> Paire de trading <code>BTC/USDT</code> <code>--dry-run</code> Mode simulation <code>false</code> <p>Exemples :</p> <pre><code># Mode simulation avec BTC/USDT\nblackbox run --dry-run\n\n# Mode simulation avec ETH/USDT\nblackbox run --symbol ETH/USDT --dry-run\n\n# Mode live (attention !)\nblackbox run --symbol BTC/USDT\n</code></pre>"},{"location":"cli/commands/#blackbox-backtest","title":"<code>blackbox backtest</code>","text":"<p>Lance un backtest sur une strat\u00e9gie.</p> <p>Arguments :</p> Argument Description <code>STRATEGY_NAME</code> Nom de la strat\u00e9gie \u00e0 tester <p>Exemple :</p> <pre><code>blackbox backtest ma_strategie\n</code></pre>"},{"location":"cli/commands/#base-de-donnees","title":"Base de donn\u00e9es","text":"<p>Le groupe de commandes <code>db</code> permet de g\u00e9rer la base de donn\u00e9es PostgreSQL.</p>"},{"location":"cli/commands/#blackbox-db-migrate","title":"<code>blackbox db migrate</code>","text":"<p>Ex\u00e9cute les migrations de base de donn\u00e9es avec Alembic.</p> <p>Options :</p> Option Description D\u00e9faut <code>-r, --revision</code> R\u00e9vision cible <code>head</code> (derni\u00e8re) <p>Exemples :</p> <pre><code># Migrer vers la derni\u00e8re version\nblackbox db migrate\n\n# Migrer vers une r\u00e9vision sp\u00e9cifique\nblackbox db migrate -r 001\n</code></pre>"},{"location":"cli/commands/#blackbox-db-migrate-status","title":"<code>blackbox db migrate-status</code>","text":"<p>Affiche l'\u00e9tat actuel des migrations.</p> <pre><code>blackbox db migrate-status\n</code></pre>"},{"location":"cli/commands/#blackbox-db-init","title":"<code>blackbox db init</code>","text":"<p>Initialise les tables de la base de donn\u00e9es (m\u00e9thode legacy).</p> <p>Note : Pr\u00e9f\u00e9rez <code>blackbox db migrate</code> pour les environnements de production.</p> <pre><code>blackbox db init\n</code></pre>"},{"location":"cli/commands/#blackbox-db-stats","title":"<code>blackbox db stats</code>","text":"<p>Affiche les statistiques sur les \u00e9v\u00e9nements stock\u00e9s.</p> <pre><code>$ blackbox db stats\n\nDatabase Statistics\n========================================\nTotal events: 1250\nDate range: 2026-01-01 to 2026-01-31\n\nBy Currency:\n  USD: 450\n  EUR: 320\n  GBP: 180\n  ...\n\nBy Impact:\n  high: 125\n  medium: 425\n  low: 700\n</code></pre>"},{"location":"cli/commands/#blackbox-db-export","title":"<code>blackbox db export</code>","text":"<p>Exporte les \u00e9v\u00e9nements en CSV ou JSON.</p> <p>Options :</p> Option Description D\u00e9faut <code>-f, --format</code> Format d'export (<code>csv</code>, <code>json</code>) <code>json</code> <code>-y, --year</code> Ann\u00e9e \u00e0 exporter Toutes <code>-m, --month</code> Mois \u00e0 exporter Tous <code>-o, --output</code> Fichier de sortie stdout <p>Exemples :</p> <pre><code># Exporter tout en JSON\nblackbox db export\n\n# Exporter un mois en CSV\nblackbox db export --format csv --year 2026 --month 1 -o events.csv\n</code></pre>"},{"location":"cli/commands/#calendrier-economique","title":"Calendrier \u00e9conomique","text":"<p>Le groupe de commandes <code>calendar</code> permet de r\u00e9cup\u00e9rer les \u00e9v\u00e9nements \u00e9conomiques depuis Forex Factory.</p>"},{"location":"cli/commands/#blackbox-calendar-fetch","title":"<code>blackbox calendar fetch</code>","text":"<p>R\u00e9cup\u00e8re le calendrier \u00e9conomique pour un mois donn\u00e9.</p> <p>Options :</p> Option Description D\u00e9faut <code>-y, --year</code> Ann\u00e9e \u00e0 r\u00e9cup\u00e9rer Ann\u00e9e courante <code>-m, --month</code> Mois \u00e0 r\u00e9cup\u00e9rer (1-12) Mois courant <code>-c, --currency</code> Filtrer par devise (peut \u00eatre r\u00e9p\u00e9t\u00e9) Toutes <code>-i, --impact</code> Niveau d'impact minimum (<code>low</code>, <code>medium</code>, <code>high</code>) Tous <code>--headless/--no-headless</code> Mode navigateur sans interface <code>true</code> <code>-j, --json-output</code> Sortie au format JSON <code>false</code> <p>Exemples :</p> <pre><code># R\u00e9cup\u00e9rer le mois courant\nblackbox calendar fetch\n\n# R\u00e9cup\u00e9rer janvier 2026\nblackbox calendar fetch --year 2026 --month 1\n\n# Filtrer par devises USD et EUR\nblackbox calendar fetch -c USD -c EUR\n\n# Uniquement les \u00e9v\u00e9nements \u00e0 fort impact\nblackbox calendar fetch --impact high\n\n# Sortie JSON\nblackbox calendar fetch -j\n</code></pre> <p>Exemple de sortie :</p> <pre><code>Fetching calendar for 2026-01...\n\nFound 45 events:\n\n[2026-01-02] [08:30] [USD] [!!!] Non-Farm Employment Change | A:223K F:215K P:212K\n[2026-01-02] [10:00] [EUR] [!!] ECB President Speech | A:- F:- P:-\n[2026-01-03] [14:00] [USD] [!] Treasury Budget Statement | A:-50B F:-45B P:-40B\n...\n</code></pre>"},{"location":"cli/commands/#blackbox-calendar-today","title":"<code>blackbox calendar today</code>","text":"<p>R\u00e9cup\u00e8re les \u00e9v\u00e9nements \u00e9conomiques du jour.</p> <p>Options :</p> Option Description D\u00e9faut <code>-c, --currency</code> Filtrer par devise Toutes <code>-H, --high-impact-only</code> Uniquement les \u00e9v\u00e9nements \u00e0 fort impact <code>false</code> <code>--headless/--no-headless</code> Mode navigateur sans interface <code>true</code> <code>-j, --json-output</code> Sortie au format JSON <code>false</code> <p>Exemples :</p> <pre><code># \u00c9v\u00e9nements du jour\nblackbox calendar today\n\n# Uniquement USD avec fort impact\nblackbox calendar today -c USD --high-impact-only\n\n# Sortie JSON\nblackbox calendar today -j\n</code></pre> <p>L\u00e9gende des impacts :</p> Symbole Impact <code>!!!</code> Fort (High) <code>!!</code> Moyen (Medium) <code>!</code> Faible (Low) <code>H</code> Jour f\u00e9ri\u00e9 <code>?</code> Inconnu"},{"location":"cli/commands/#codes-de-retour","title":"Codes de retour","text":"Code Signification 0 Succ\u00e8s 1 Erreur g\u00e9n\u00e9rale 2 Erreur de configuration"},{"location":"cli/commands/#variables-denvironnement","title":"Variables d'environnement","text":"<p>Le CLI respecte les variables d'environnement d\u00e9finies dans <code>.env</code> :</p> <pre><code># Activer le mode debug\nDEBUG=true\n\n# Autres configurations \u00e0 venir\n</code></pre>"},{"location":"data/calendar/","title":"Calendrier \u00c9conomique","text":"<p>Le module de calendrier \u00e9conomique permet de r\u00e9cup\u00e9rer les \u00e9v\u00e9nements \u00e9conomiques majeurs depuis Forex Factory.</p>"},{"location":"data/calendar/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>R\u00e9cup\u00e9ration des \u00e9v\u00e9nements pass\u00e9s et futurs</li> <li>Filtrage par devise (USD, EUR, GBP, etc.)</li> <li>Filtrage par niveau d'impact (low, medium, high)</li> <li>Valeurs actual, forecast et previous</li> <li>Mode headless pour l'ex\u00e9cution en arri\u00e8re-plan</li> <li>Gestion anti-d\u00e9tection bot (undetected-chromedriver)</li> <li>D\u00e9lais al\u00e9atoires pour simuler un comportement humain</li> </ul>"},{"location":"data/calendar/#utilisation","title":"Utilisation","text":""},{"location":"data/calendar/#en-python","title":"En Python","text":"<pre><code>from datetime import date\nfrom blackbox.data import ForexFactoryScraper, Impact\nfrom blackbox.data.config import ForexFactoryConfig, BrowserConfig\n\n# Configuration personnalis\u00e9e (optionnel)\nconfig = ForexFactoryConfig(\n    browser=BrowserConfig(headless=True),\n)\n\n# Utilisation avec context manager (recommand\u00e9)\nwith ForexFactoryScraper(config) as scraper:\n    # R\u00e9cup\u00e9rer les \u00e9v\u00e9nements du jour\n    events = scraper.fetch_today()\n\n    # R\u00e9cup\u00e9rer un mois complet\n    calendar = scraper.fetch_month(2026, 1)\n\n    # Filtrer par devise\n    usd_events = calendar.filter_by_currency([\"USD\", \"EUR\"])\n\n    # Filtrer par impact\n    high_impact = calendar.filter_by_impact(Impact.HIGH)\n\n    for event in high_impact:\n        print(f\"{event.date} {event.time} - {event.currency}: {event.event_name}\")\n        print(f\"  Actual: {event.actual}, Forecast: {event.forecast}, Previous: {event.previous}\")\n</code></pre>"},{"location":"data/calendar/#via-cli","title":"Via CLI","text":"<pre><code># \u00c9v\u00e9nements du jour\nblackbox calendar today\n\n# Mois complet\nblackbox calendar fetch --year 2026 --month 1\n\n# Filtres\nblackbox calendar fetch -c USD -c EUR --impact high\n\n# Sortie JSON\nblackbox calendar today -j\n</code></pre>"},{"location":"data/calendar/#via-api","title":"Via API","text":"<pre><code># \u00c9v\u00e9nements du jour\ncurl \"http://localhost:8000/api/v1/calendar/today\"\n\n# Mois complet avec filtres\ncurl \"http://localhost:8000/api/v1/calendar/month?year=2026&amp;month=1&amp;currencies=USD,EUR&amp;high_impact_only=true\"\n</code></pre>"},{"location":"data/calendar/#modeles-de-donnees","title":"Mod\u00e8les de donn\u00e9es","text":""},{"location":"data/calendar/#economicevent","title":"EconomicEvent","text":"<p>Repr\u00e9sente un \u00e9v\u00e9nement \u00e9conomique unique.</p> Champ Type Description <code>date</code> <code>date</code> Date de l'\u00e9v\u00e9nement <code>time</code> <code>time \\| None</code> Heure (None si \"All Day\") <code>currency</code> <code>str</code> Devise concern\u00e9e (2-5 caract\u00e8res) <code>impact</code> <code>Impact</code> Niveau d'impact <code>event_name</code> <code>str</code> Nom de l'\u00e9v\u00e9nement <code>actual</code> <code>float \\| None</code> Valeur r\u00e9elle publi\u00e9e (normalis\u00e9e) <code>forecast</code> <code>float \\| None</code> Pr\u00e9vision (normalis\u00e9e) <code>previous</code> <code>float \\| None</code> Valeur pr\u00e9c\u00e9dente (normalis\u00e9e) <code>event_type</code> <code>EventType</code> Cat\u00e9gorie de l'\u00e9v\u00e9nement <code>direction</code> <code>int</code> Direction d'impact (+1 ou -1) <code>weight</code> <code>int</code> Poids d'importance (1-10) <code>surprise</code> <code>float \\| None</code> Score de surprise normalis\u00e9 (voir Scoring)"},{"location":"data/calendar/#normalisation-des-valeurs","title":"Normalisation des valeurs","text":"<p>Les valeurs \u00e9conomiques (<code>actual</code>, <code>forecast</code>, <code>previous</code>) sont automatiquement normalis\u00e9es lors du parsing. Cela permet de manipuler directement des nombres pour les calculs de surprise ou d'analyse.</p>"},{"location":"data/calendar/#formats-supportes","title":"Formats support\u00e9s","text":"Format brut Valeur normalis\u00e9e Description <code>\"223K\"</code> <code>223000.0</code> Milliers <code>\"1.5M\"</code> <code>1500000.0</code> Millions <code>\"-50B\"</code> <code>-50000000000.0</code> Milliards (n\u00e9gatif) <code>\"2T\"</code> <code>2000000000000.0</code> Trillions <code>\"2.5%\"</code> <code>0.025</code> Pourcentage \u2192 d\u00e9cimal <code>\"-1.5%\"</code> <code>-0.015</code> Pourcentage n\u00e9gatif <code>\"1,234.56\"</code> <code>1234.56</code> S\u00e9parateurs de milliers <code>\"&lt;0.1%\"</code> <code>0.001</code> Op\u00e9rateurs de comparaison ignor\u00e9s"},{"location":"data/calendar/#utilisation_1","title":"Utilisation","text":"<pre><code>from blackbox.data import ForexFactoryScraper\n\nwith ForexFactoryScraper() as scraper:\n    events = scraper.fetch_today()\n\n    for event in events:\n        if event.surprise is not None:\n            # Le score de surprise est calcul\u00e9 automatiquement\n            print(f\"{event.event_name}: Surprise = {event.surprise:.2%}\")\n</code></pre> <p>Score de surprise automatique</p> <p>Le champ <code>surprise</code> est calcul\u00e9 automatiquement lors de la cr\u00e9ation de l'\u00e9v\u00e9nement. Voir la documentation Scoring pour plus de d\u00e9tails sur la formule.</p>"},{"location":"data/calendar/#fonction-utilitaire","title":"Fonction utilitaire","text":"<p>Le module <code>normalizer</code> expose \u00e9galement des fonctions utilitaires :</p> <pre><code>from blackbox.data.normalizer import normalize_value, format_normalized_value\n\n# Normalisation\nvalue = normalize_value(\"223K\")  # -&gt; 223000.0\nvalue = normalize_value(\"2.5%\")  # -&gt; 0.025\n\n# Formatage inverse\ntext = format_normalized_value(223000.0)  # -&gt; \"223.00K\"\ntext = format_normalized_value(1500000.0, precision=1)  # -&gt; \"1.5M\"\n</code></pre>"},{"location":"data/calendar/#impact","title":"Impact","text":"<p>Enum des niveaux d'impact :</p> Valeur Description <code>Impact.LOW</code> Faible impact <code>Impact.MEDIUM</code> Impact moyen <code>Impact.HIGH</code> Fort impact <code>Impact.HOLIDAY</code> Jour f\u00e9ri\u00e9 <code>Impact.UNKNOWN</code> Non d\u00e9fini"},{"location":"data/calendar/#eventtype","title":"EventType","text":"<p>Enum des types d'\u00e9v\u00e9nements \u00e9conomiques pour le scoring fondamental :</p> Valeur Description <code>EventType.INTEREST_RATE</code> D\u00e9cisions de taux d'int\u00e9r\u00eat <code>EventType.EMPLOYMENT</code> Donn\u00e9es d'emploi (NFP, ch\u00f4mage) <code>EventType.INFLATION</code> Indicateurs d'inflation (CPI, PPI) <code>EventType.GROWTH</code> Croissance \u00e9conomique (GDP, ventes) <code>EventType.PMI</code> Indices des directeurs d'achat <code>EventType.HOUSING</code> Donn\u00e9es immobili\u00e8res <code>EventType.SENTIMENT</code> Indicateurs de confiance <code>EventType.TRADE</code> Balance commerciale <code>EventType.OTHER</code> Autres \u00e9v\u00e9nements"},{"location":"data/calendar/#direction-et-poids","title":"Direction et Poids","text":"<p>Les \u00e9v\u00e9nements sont enrichis automatiquement avec des m\u00e9tadonn\u00e9es pour le scoring :</p> <ul> <li>Direction (<code>+1</code> ou <code>-1</code>) : Indique si une valeur plus \u00e9lev\u00e9e est haussi\u00e8re (+1) ou baissi\u00e8re (-1) pour la devise</li> <li>Exemple : NFP (+1) - plus d'emplois = bullish pour USD</li> <li> <p>Exemple : Unemployment Rate (-1) - plus de ch\u00f4mage = bearish pour USD</p> </li> <li> <p>Poids (1-10) : Importance de l'\u00e9v\u00e9nement pour le march\u00e9</p> </li> <li>10 : \u00c9v\u00e9nements majeurs (NFP, CPI, d\u00e9cisions de taux)</li> <li>5-7 : \u00c9v\u00e9nements importants (PMI, GDP pr\u00e9liminaire)</li> <li>1-4 : \u00c9v\u00e9nements mineurs (housing, sentiment)</li> </ul>"},{"location":"data/calendar/#systeme-de-mapping-intelligent","title":"Syst\u00e8me de mapping intelligent","text":"<p>Le module <code>event_mapping.py</code> utilise un syst\u00e8me de matching \u00e0 deux niveaux pour cat\u00e9goriser automatiquement les \u00e9v\u00e9nements :</p>"},{"location":"data/calendar/#1-correspondance-exacte-prioritaire","title":"1. Correspondance exacte (prioritaire)","text":"<p>Pour les \u00e9v\u00e9nements connus avec des m\u00e9tadonn\u00e9es sp\u00e9cifiques :</p> <pre><code>from blackbox.data.event_mapping import get_event_metadata\n\n# Correspondance exacte\nmetadata = get_event_metadata(\"Non-Farm Employment Change\")\n# \u2192 EventType.EMPLOYMENT, direction=+1, weight=10\n</code></pre>"},{"location":"data/calendar/#2-pattern-matching-regex-fallback","title":"2. Pattern matching regex (fallback)","text":"<p>Pour les variantes r\u00e9gionales et pr\u00e9liminaires, des patterns regex sont utilis\u00e9s :</p> Pattern Type Exemples match\u00e9s <code>*PMI*</code> PMI Spanish Manufacturing PMI, Italian Services PMI, Flash PMI <code>*CPI*</code> INFLATION German Prelim CPI m/m, Core CPI Flash Estimate y/y <code>*PPI*</code> INFLATION German PPI m/m, Core PPI y/y <code>*Unemployment*</code> EMPLOYMENT Spanish Unemployment Change, German Unemployment Rate <code>*Trade Balance*</code> TRADE French Trade Balance, Italian Trade Balance <code>*Retail Sales*</code> GROWTH German Retail Sales m/m, Core Retail Sales m/m <code>*GDP*</code> GROWTH French Flash GDP q/q, Prelim GDP q/q <code>*Consumer*Confidence*</code> SENTIMENT CB Consumer Confidence, GfK Consumer Confidence <code>*Building*</code> HOUSING Building Permits, Building Approvals m/m <code>*Home Sales*</code> HOUSING New Home Sales, Existing Home Sales <pre><code># Pattern matching automatique\nmetadata = get_event_metadata(\"Spanish Manufacturing PMI\")\n# \u2192 EventType.PMI, direction=+1, weight=6\n\nmetadata = get_event_metadata(\"German Prelim CPI m/m\")\n# \u2192 EventType.INFLATION, direction=+1, weight=9\n</code></pre>"},{"location":"data/calendar/#priorites-des-patterns","title":"Priorit\u00e9s des patterns","text":"<p>Les patterns sont ordonn\u00e9s par priorit\u00e9 (plus \u00e9lev\u00e9e = v\u00e9rifi\u00e9 en premier) :</p> Priorit\u00e9 Cat\u00e9gorie 100 Interest Rate (d\u00e9cisions de taux) 90 Employment (emploi, ch\u00f4mage) 85 Inflation (CPI, PPI, PCE) 80 Growth (GDP, retail sales) 75 PMI 70 Housing 65 Sentiment 60 Trade 10 Other (speakers, auctions)"},{"location":"data/calendar/#evenements-non-categorises","title":"\u00c9v\u00e9nements non cat\u00e9goris\u00e9s","text":"<p>Les \u00e9v\u00e9nements sans correspondance re\u00e7oivent les valeurs par d\u00e9faut : - <code>event_type</code>: <code>EventType.OTHER</code> - <code>direction</code>: <code>+1</code> - <code>weight</code>: <code>1</code></p>"},{"location":"data/calendar/#calendarday","title":"CalendarDay","text":"<p>\u00c9v\u00e9nements d'une journ\u00e9e.</p> Propri\u00e9t\u00e9 Type Description <code>date</code> <code>date</code> Date <code>events</code> <code>list[EconomicEvent]</code> Liste des \u00e9v\u00e9nements <code>high_impact_events</code> <code>list[EconomicEvent]</code> \u00c9v\u00e9nements \u00e0 fort impact <code>has_high_impact</code> <code>bool</code> A des \u00e9v\u00e9nements \u00e0 fort impact"},{"location":"data/calendar/#calendarmonth","title":"CalendarMonth","text":"<p>Calendrier mensuel complet.</p> Propri\u00e9t\u00e9/M\u00e9thode Type Description <code>year</code> <code>int</code> Ann\u00e9e <code>month</code> <code>int</code> Mois (1-12) <code>days</code> <code>list[CalendarDay]</code> Jours du mois <code>all_events</code> <code>list[EconomicEvent]</code> Tous les \u00e9v\u00e9nements <code>high_impact_events</code> <code>list[EconomicEvent]</code> \u00c9v\u00e9nements \u00e0 fort impact <code>filter_by_currency(currencies)</code> <code>list[EconomicEvent]</code> Filtre par devise <code>filter_by_impact(min_impact)</code> <code>list[EconomicEvent]</code> Filtre par impact minimum"},{"location":"data/calendar/#configuration","title":"Configuration","text":""},{"location":"data/calendar/#forexfactoryconfig","title":"ForexFactoryConfig","text":"Option Type D\u00e9faut Description <code>base_url</code> <code>str</code> <code>https://www.forexfactory.com/calendar</code> URL de base <code>max_retries</code> <code>int</code> <code>3</code> Nombre de tentatives <code>retry_delay</code> <code>float</code> <code>5.0</code> D\u00e9lai entre tentatives (secondes) <code>cache_ttl</code> <code>int</code> <code>300</code> Dur\u00e9e du cache (secondes) <code>browser</code> <code>BrowserConfig</code> - Configuration navigateur <code>delays</code> <code>ScraperDelays</code> - Configuration des d\u00e9lais"},{"location":"data/calendar/#browserconfig","title":"BrowserConfig","text":"Option Type D\u00e9faut Description <code>headless</code> <code>bool</code> <code>True</code> Mode sans interface <code>user_agent</code> <code>str \\| None</code> <code>None</code> User-agent personnalis\u00e9 <code>page_load_timeout</code> <code>int</code> <code>30</code> Timeout chargement page (s) <code>implicit_wait</code> <code>int</code> <code>10</code> Attente implicite (s) <code>window_width</code> <code>int</code> <code>1920</code> Largeur fen\u00eatre <code>window_height</code> <code>int</code> <code>1080</code> Hauteur fen\u00eatre"},{"location":"data/calendar/#scraperdelays","title":"ScraperDelays","text":"<p>D\u00e9lais al\u00e9atoires pour simuler un comportement humain :</p> Option Type D\u00e9faut Description <code>page_load_min/max</code> <code>float</code> <code>2.0/4.0</code> D\u00e9lai apr\u00e8s chargement <code>action_min/max</code> <code>float</code> <code>0.5/1.5</code> D\u00e9lai entre actions <code>pagination_min/max</code> <code>float</code> <code>3.0/6.0</code> D\u00e9lai entre pages"},{"location":"data/calendar/#gestion-des-erreurs","title":"Gestion des erreurs","text":"<p>Le module d\u00e9finit des exceptions sp\u00e9cifiques :</p> Exception Description <code>ScraperError</code> Erreur g\u00e9n\u00e9rique de scraping <code>BrowserError</code> Erreur li\u00e9e au navigateur <code>BrowserInitializationError</code> \u00c9chec d'initialisation du navigateur <code>PageLoadError</code> \u00c9chec de chargement de page <code>ParsingError</code> \u00c9chec de parsing HTML <code>BlockedError</code> Requ\u00eate bloqu\u00e9e (Cloudflare, etc.)"},{"location":"data/calendar/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Google Chrome install\u00e9 sur le syst\u00e8me</li> <li>ChromeDriver compatible (g\u00e9r\u00e9 automatiquement par undetected-chromedriver)</li> </ul>"},{"location":"data/calendar/#notes-techniques","title":"Notes techniques","text":""},{"location":"data/calendar/#anti-detection","title":"Anti-d\u00e9tection","text":"<p>Le scraper utilise plusieurs techniques pour \u00e9viter la d\u00e9tection :</p> <ol> <li>undetected-chromedriver : Masque les signatures d'automatisation</li> <li>Rotation des user-agents : Pool de user-agents r\u00e9alistes</li> <li>D\u00e9lais al\u00e9atoires : Simule un comportement humain</li> <li>Options Chrome : D\u00e9sactive les fonctionnalit\u00e9s de d\u00e9tection</li> </ol>"},{"location":"data/calendar/#performance","title":"Performance","text":"<ul> <li>Le scraping d'un mois complet peut prendre plusieurs minutes</li> <li>Utilisez l'API avec le endpoint <code>/refresh</code> pour les t\u00e2ches en arri\u00e8re-plan</li> <li>Les filtres c\u00f4t\u00e9 scraper (<code>currencies</code> dans <code>fetch_month</code>) r\u00e9duisent les donn\u00e9es retourn\u00e9es mais pas le temps de scraping</li> <li>Les donn\u00e9es sont persist\u00e9es jour par jour, permettant la reprise en cas d'interruption</li> </ul>"},{"location":"data/calendar/#reprise-automatique","title":"Reprise automatique","text":"<p>Si le scraping est interrompu (erreur, Ctrl+C, crash), il suffit de relancer la m\u00eame commande. Les jours d\u00e9j\u00e0 scrap\u00e9s seront automatiquement saut\u00e9s.</p> <pre><code># Relancer apr\u00e8s interruption - reprend l\u00e0 o\u00f9 \u00e7a s'est arr\u00eat\u00e9\nblackbox calendar fetch --year 2026 --month 1\n</code></pre>"},{"location":"data/calendar/#depannage","title":"D\u00e9pannage","text":""},{"location":"data/calendar/#erreur-target-window-already-closed","title":"Erreur \"target window already closed\"","text":"<p>Cette erreur survient quand la fen\u00eatre Chrome se ferme pendant le scraping (crash, fermeture manuelle, timeout).</p> <p>Solution :</p> <ol> <li> <p>Tuer les processus Chrome zombies :    <pre><code>pkill -f \"chrome.*undetected\"\n</code></pre></p> </li> <li> <p>Relancer la commande (reprise automatique) :    <pre><code>blackbox calendar fetch --year 2026 --month 1\n</code></pre></p> </li> </ol>"},{"location":"data/calendar/#processus-chrome-qui-restent-en-arriere-plan","title":"Processus Chrome qui restent en arri\u00e8re-plan","text":"<p>Apr\u00e8s un crash ou une interruption brutale, des processus Chrome peuvent rester actifs.</p> <pre><code># Voir les processus Chrome li\u00e9s au scraper\nps aux | grep \"chrome.*undetected\"\n\n# Les tuer\npkill -f \"chrome.*undetected\"\n</code></pre>"},{"location":"data/calendar/#la-base-de-donnees-nexiste-pas","title":"La base de donn\u00e9es n'existe pas","text":"<pre><code>relation \"economic_events\" does not exist\n</code></pre> <p>Solution : Ex\u00e9cuter les migrations :</p> <pre><code># M\u00e9thode recommand\u00e9e (avec Alembic)\nblackbox db migrate\n\n# Ou m\u00e9thode legacy\nblackbox db init\n</code></pre>"},{"location":"data/calendar/#colonnes-manquantes-apres-mise-a-jour","title":"Colonnes manquantes apr\u00e8s mise \u00e0 jour","text":"<pre><code>column \"event_type\" does not exist\n</code></pre> <p>Solution : Appliquer les nouvelles migrations :</p> <pre><code># V\u00e9rifier le statut des migrations\nblackbox db migrate-status\n\n# Appliquer les migrations manquantes\nblackbox db migrate\n</code></pre>"},{"location":"data/scoring/","title":"Scoring","text":"<p>Le module de scoring fournit des fonctions pour calculer des scores li\u00e9s aux \u00e9v\u00e9nements \u00e9conomiques, notamment le score de surprise.</p>"},{"location":"data/scoring/#score-de-surprise","title":"Score de Surprise","text":"<p>Le score de surprise mesure l'\u00e9cart entre le r\u00e9sultat r\u00e9el (<code>actual</code>) et les attentes du march\u00e9 (<code>forecast</code>), normalis\u00e9 par la valeur du forecast.</p>"},{"location":"data/scoring/#formule","title":"Formule","text":"<p>$$ \\text{surprise} = \\text{direction} \\times \\frac{\\text{actual} - \\text{forecast}}{|\\text{forecast}|} $$</p> <p>O\u00f9 :</p> <ul> <li>actual : Valeur r\u00e9elle publi\u00e9e</li> <li>forecast : Pr\u00e9vision du march\u00e9</li> <li>direction : Direction d'impact (+1 ou -1)</li> </ul>"},{"location":"data/scoring/#interpretation","title":"Interpr\u00e9tation","text":"Valeur Interpr\u00e9tation <code>&gt; 0</code> Surprise positive (bullish pour la devise si direction=+1) <code>= 0</code> Aucune surprise (actual = forecast) <code>&lt; 0</code> Surprise n\u00e9gative (bearish pour la devise si direction=+1) <code>None</code> Calcul impossible (actual, forecast ou forecast=0)"},{"location":"data/scoring/#exemples","title":"Exemples","text":"actual forecast direction surprise Explication 300000 200000 +1 +0.50 50% au-dessus des attentes 0.04 0.035 -1 -0.143 Plus \u00e9lev\u00e9 = bearish (ex: inflation) 0.002 0.003 +1 -0.333 33% en-dessous des attentes None 0.003 +1 None actual non disponible 0.002 None +1 None forecast non disponible 0.002 0 +1 None Division par z\u00e9ro impossible"},{"location":"data/scoring/#utilisation","title":"Utilisation","text":""},{"location":"data/scoring/#calcul-automatique","title":"Calcul automatique","text":"<p>Le score de surprise est calcul\u00e9 automatiquement lors de la cr\u00e9ation d'un <code>EconomicEvent</code> :</p> <pre><code>from blackbox.data.models import EconomicEvent\nfrom datetime import date\n\nevent = EconomicEvent(\n    date=date(2026, 1, 15),\n    currency=\"USD\",\n    event_name=\"Non-Farm Employment Change\",\n    actual=300000,\n    forecast=200000,\n    direction=+1,\n    weight=10,\n)\n\nprint(event.surprise)  # 0.5 (50% au-dessus des attentes)\n</code></pre>"},{"location":"data/scoring/#fonction-utilitaire","title":"Fonction utilitaire","text":"<p>Le module <code>scoring</code> expose \u00e9galement la fonction de calcul directement :</p> <pre><code>from blackbox.data.scoring import calculate_surprise\n\n# Calcul manuel\nsurprise = calculate_surprise(\n    actual=300000,\n    forecast=200000,\n    direction=+1\n)\nprint(surprise)  # 0.5\n\n# Cas o\u00f9 le calcul est impossible\nsurprise = calculate_surprise(actual=None, forecast=200000, direction=+1)\nprint(surprise)  # None\n\nsurprise = calculate_surprise(actual=100, forecast=0, direction=+1)\nprint(surprise)  # None (division par z\u00e9ro)\n</code></pre>"},{"location":"data/scoring/#filtrage-par-surprise","title":"Filtrage par surprise","text":"<p>Exemple pour filtrer les \u00e9v\u00e9nements avec une forte surprise :</p> <pre><code>from blackbox.data import ForexFactoryScraper\n\nwith ForexFactoryScraper() as scraper:\n    events = scraper.fetch_today()\n\n    # \u00c9v\u00e9nements avec surprise &gt; 10%\n    big_surprises = [\n        e for e in events\n        if e.surprise is not None and abs(e.surprise) &gt; 0.10\n    ]\n\n    for event in big_surprises:\n        direction = \"+\" if event.surprise &gt; 0 else \"\"\n        print(f\"{event.currency} {event.event_name}: {direction}{event.surprise:.1%}\")\n</code></pre>"},{"location":"data/scoring/#persistance","title":"Persistance","text":"<p>Le score de surprise est persist\u00e9 en base de donn\u00e9es dans la colonne <code>surprise</code> de la table <code>economic_events</code>.</p>"},{"location":"data/scoring/#migration","title":"Migration","text":"<p>La migration <code>003_add_surprise_column</code> :</p> <ol> <li>Ajoute la colonne <code>surprise</code> (FLOAT, nullable)</li> <li>Calcule automatiquement le score pour les \u00e9v\u00e9nements existants</li> </ol> <pre><code>-- Formule appliqu\u00e9e lors de la migration\nUPDATE economic_events\nSET surprise = direction * (actual - forecast) / ABS(forecast)\nWHERE actual IS NOT NULL\n  AND forecast IS NOT NULL\n  AND forecast != 0;\n</code></pre>"},{"location":"data/scoring/#mise-a-jour-automatique","title":"Mise \u00e0 jour automatique","text":"<p>Lors de l'insertion ou de la mise \u00e0 jour d'un \u00e9v\u00e9nement via le repository, le score de surprise est :</p> <ol> <li>Calcul\u00e9 automatiquement par le mod\u00e8le Pydantic</li> <li>Persist\u00e9 dans la colonne <code>surprise</code></li> <li>Mis \u00e0 jour si <code>actual</code> ou <code>forecast</code> change</li> </ol>"},{"location":"data/scoring/#cas-dutilisation","title":"Cas d'utilisation","text":""},{"location":"data/scoring/#trading-sur-les-surprises-economiques","title":"Trading sur les surprises \u00e9conomiques","text":"<pre><code>def should_trade(event: EconomicEvent) -&gt; bool:\n    \"\"\"D\u00e9termine si un \u00e9v\u00e9nement justifie une action de trading.\"\"\"\n    if event.surprise is None:\n        return False\n\n    # Seuil de 20% de surprise\n    if abs(event.surprise) &lt; 0.20:\n        return False\n\n    # \u00c9v\u00e9nements \u00e0 fort impact uniquement\n    if event.weight &lt; 8:\n        return False\n\n    return True\n</code></pre>"},{"location":"data/scoring/#analyse-des-tendances","title":"Analyse des tendances","text":"<pre><code>def analyze_currency_surprises(events: list[EconomicEvent], currency: str) -&gt; dict:\n    \"\"\"Analyse les surprises pour une devise.\"\"\"\n    currency_events = [e for e in events if e.currency == currency]\n    surprises = [e.surprise for e in currency_events if e.surprise is not None]\n\n    if not surprises:\n        return {\"count\": 0, \"avg\": None, \"positive_ratio\": None}\n\n    return {\n        \"count\": len(surprises),\n        \"avg\": sum(surprises) / len(surprises),\n        \"positive_ratio\": sum(1 for s in surprises if s &gt; 0) / len(surprises),\n    }\n</code></pre>"},{"location":"data/scoring/#api-reference","title":"API Reference","text":""},{"location":"data/scoring/#calculate_surprise","title":"<code>calculate_surprise</code>","text":"<pre><code>def calculate_surprise(\n    actual: float | None,\n    forecast: float | None,\n    direction: int,\n) -&gt; float | None:\n    \"\"\"\n    Calcule le score de surprise normalis\u00e9.\n\n    Args:\n        actual: Valeur r\u00e9elle publi\u00e9e.\n        forecast: Pr\u00e9vision du march\u00e9.\n        direction: Direction d'impact (+1 ou -1).\n\n    Returns:\n        Score de surprise normalis\u00e9, ou None si le calcul est impossible.\n    \"\"\"\n</code></pre>"},{"location":"data/scoring/#voir-aussi","title":"Voir aussi","text":"<ul> <li>Calendrier \u00c9conomique - Mod\u00e8le <code>EconomicEvent</code></li> <li>Architecture - Structure du module <code>data</code></li> </ul>"}]}